{"version":3,"sources":["tab_control.js","documentation.js","editor.js","maybe.js","apollo/parsing.js","apollo/elements/configuration.js","apollo/elements/uielement.js","apollo/elements/label.js","apollo/elements/container.js","apollo/elements/element.js","apollo/elements/grid.js","apollo/layout.js","apollo/elements/window.js","apollo/renderer.js","display.js","example_layout.js","index.js"],"names":["TabControl","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","activeTab","children","label","handleTabClicked","tab","setState","_this2","tabs","map","classList","react_default","a","createElement","key","className","onClick","contents","find","React","Component","Info","href","target","HelpText","grid","margins","Documentation","help","candidate","DocumentationViewer","tab_control","documentation_Info","documentation_Documentation","Layout","handleChange","bind","assertThisInitialized","handleKeyPress","e","onLayoutChanged","value","cursorPosition","selectionStart","start","end","buffer","test","length","slice","console","log","showDocumentation","onChange","onKeyDown","initialLayout","Code","Editor","editor_Layout","handleLayoutChanged","editor_Code","Maybe","_value","createClass","f","x","List","head","items","type","SExpType","item","push","BoolLiteral","IntLiteral","StringLiteral","SSymbol","Symbol","ParseError","message","line","column","Constructor","name","values","str","index","Some","None","KnownContainers","freeze","Grid","ListView","KnownElements","Label","KnownType","Container","Element","getConstructorType","constructor","startsWith","getConstructor","expression","isDigit","c","LiteralType","Int","Float","String","FloatLiteral","Configuration","meta","backgroundColour","fontColour","vertical","horizontal","padding","horizontalAlignment","Alignment","Start","verticalAlignment","fontSize","Center","End","UIElement","config","parent","bounds","arguments","undefined","getChildBounds","horizontalMarginSpace","width","verticalMarginSpace","height","y","LabelConfiguration","_Configuration","caption","inherits","_UIElement","renderer","clip","captionText","getBounds","drawRectangle","drawText","MetaNamespace","MetaData","namespace","id","containerNamespace","metaId","parseGridMeta","count","i","get","GridMetaId","Row","Column","RowSpan","ColumnSpan","isSome","parseMeta","apply","element","requestTextLayout","requestRender","ContainedElement","parseMargins","failed","getAlignment","getColour","colour","colourConstructor","r","g","b","parseColour","parseElement","alignment","maybeAlignment","parseAlignment","first","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","v","_iterator","iterator","next","done","_ret","err","return","parseLabel","Create","_ref","_ref2","slicedToArray","addChild","Bounds","GridElement","row","rowSpan","columnSpan","getCellBounds","startingPosition","actualSpace","getSpannedCellBounds","rows","columns","_Container","rowGap","columnGap","itemSource","itemTemplate","child","applyMetaData","setParent","data","Math","max","min","definitions","unallocatedSpace","currentPosition","gap","totalProportionalUnits","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","definition","unit","Unit","Fixed","space","desiredSpace","proportionalSpace","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","Proportional","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","allocateDefinitionSpace","calculateGridDimensions","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","layoutChildren","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","render","GridConfiguration","_this3","RowColumnDefinition","parseRowColumn","proportional","fixed","createGrid","createContainerItems","itemList","createContainer","createItems","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","template","_iterator8","parseGrid","_ref3","_ref4","_ref5","_ref6","container","metaData","finishContainer","UIWindow","canvas","clientWidth","clientHeight","Renderer","context","getContext","fillStyle","fillRect","windowWidth","windowHeight","clippedWidth","clippedHeight","layout","fillText","Display","display","ref","node","parentElement","window","setRenderer","result","input","opener","closer","brackets","expressions","currentLine","currentColumn","topLevelExpressions","completedExpression","pop","add","top","includes","j","Number","parseInt","read","clear","root","_ref7","_ref8","loadLayout","exception","ExampleLayout","ApolloApp","setTimeout","src_documentation","src_editor","src_display","ReactDOM","src_ApolloApp","document","querySelector"],"mappings":"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","file":"static/js/main.e64c08b3.chunk.js","sourcesContent":["/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport React from 'react';\nimport './css/tabs.css';\n\nclass TabControl extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            activeTab: props.children[0].props.label\n        };\n\n        this.handleTabClicked = tab => this.setState({activeTab: tab});\n    }\n\n    render() {\n        let tabs = this.props.children.map(tab => {\n            let classList = tab.props.label === this.state.activeTab ? 'tab tab--active' : 'tab';\n            return (<p key={tab.props.label} className={classList} \n                        onClick={() => this.handleTabClicked(tab.props.label)}>\n                            {tab.props.label}\n                   </p>\n        )});\n        let contents = this.props.children.find(tab => tab.props.label === this.state.activeTab);\n\n        return (\n            <div className='expand'>\n                <div className=\"tabList\">{tabs}</div>\n\n                {contents}\n            </div>\n        );\n    }\n}\n\nexport default TabControl;","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport React from 'react';\nimport TabControl from './tab_control';\nimport './css/documentation.css';\n\nconst Info = () => (<p className=\"docViewer\">This is a live demo of Apollo UI layouts \n        for the <a href=\"https://saturn-os.org\" target=\"blank\">Saturn OS</a>\n        <br/>\n        <br/>\n\n        You can edit the layout in the editor below, which will be parsed\n        and rendered in the canvas to the right.\n    </p>);\n\nconst HelpText = {\n    \"grid\": `A Grid is a container that lays out its children in rows and columns.\n        Row/columns can be proportionally sized or given a fixed size.\n        `,\n    \"margins\": `Margins are the empty space between some UI element\n        and its parent container. You can give horizontal or vertical margins`\n};\n\nclass Documentation extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {help: ''};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n\n        if (state.candidate !== props.candidate) {\n            return {\n                help: HelpText[props.candidate] || \"\"\n            };\n        }\n\n        return null;\n    }\n\n    render() {\n        return <p className=\"docViewer\">{this.state.help}</p>;\n    }\n}\n\nclass DocumentationViewer extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {candidate: props.candidate};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n\n        if (state.candidate !== props.candidate) {\n            return {\n                candidate: props.candidate\n            };\n        }\n\n        return null;\n    }\n\n    render() {\n        return (<section className=\"documentation\">\n            <TabControl>\n                <Info label=\"Info\" />\n                <Documentation label=\"Documentation\" candidate={this.state.candidate} />\n            </TabControl>\n        </section>);\n    }\n}\n\nexport default DocumentationViewer;","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport React from 'react';\nimport TabControl from './tab_control';\nimport './css/editor.css';\n//import {debounce} from 'lodash';\n\nclass Layout extends React.Component {\n    constructor(props) {\n        super(props);\n        this.handleChange = this.handleChange.bind(this);\n        this.handleKeyPress = this.handleKeyPress.bind(this);\n    }\n\n    handleChange(e) {\n        this.props.onLayoutChanged(e.target.value);\n//        let value = e.target.value;\n  //      debounce(function () {\n    //        this.props.onLayoutChanged(value);\n      //  }, 1000);\n    }\n\n    handleKeyPress(e) {\n\t\tif (e.key === \"F1\") {\n\t\t\tlet cursorPosition = e.target.selectionStart;\n\n\t\t\tif (e.target.value[cursorPosition] !== ' ') {\n\t\t\t\tlet start = cursorPosition;\n\t\t\t\tlet end = cursorPosition;\n\t\t\t\tlet buffer = e.target.value;\n\n\t\t\t\tfor (; start > 0; start--) {\n\t\t\t\t\tif (!/[^\\s(]/.test(buffer[start])) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (; end < buffer.length; end++) {\n\t\t\t\t\tif (!/[^\\s(]/.test(buffer[end])) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet candidate = buffer.slice(start + 1, end);\n\n\t\t\t\tif (candidate.length > 0) {\n\t\t\t\t\tconsole.log(candidate);\n\t\t\t\t\tthis.props.showDocumentation(candidate);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    }\n\n    render() {\n        return (<textarea className='expand'  \n          onChange={this.handleChange} \n          onKeyDown={this.handleKeyPress}\n          value={this.props.initialLayout}></textarea>);\n    }\n}\n\nconst Code = () => <p>Code<br/>TODO</p>;\n\nclass Editor extends React.Component {\n\n    render() {\n        return (\n            <section className=\"editor\">\n                <TabControl>\n\t\t\t\t\t<Layout label=\"Layout\" \n\t\t\t\t\t\tonLayoutChanged={this.props.handleLayoutChanged} \n\t\t\t\t\t\tshowDocumentation={this.props.showDocumentation}\n\t\t\t\t\t\tinitialLayout={this.props.initialLayout}/>\n                    <Code label=\"Code\"/>\n                </TabControl>\n            </section>\n        );\n    }\n}\n\nexport default Editor;","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nexport class Maybe {\n    constructor(value) {\n        if (typeof value === \"undefined\") {\n            this._value = null;\n        }\n        else {\n            this._value = value;\n        }\n    }\n\n    static Some(x) {\n        return new Maybe(x);\n    }\n\n    static None() {\n        return new Maybe();\n    }\n\n    bind(f) {\n        if (this._value == null) {\n            return this;\n        }\n        else {\n            return f(this._value);\n        }\n    }\n\n    isSome() {\n        return this._value !== null;\n    }\n\n    value() {\n        return this._value;\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {Maybe} from '../maybe';\n\nfunction bracketMatches(opener, closer) {\n    if (opener === '(') {\n        return closer === ')';\n    }\n    else if (opener === '[') {\n        return closer === ']';\n    }\n    else if (opener === '{') {\n        return closer === '}';\n    }\n    else {\n        return;\n    }\n}\n\nexport class List {\n    constructor(head) {\n        if (typeof(head) !== 'undefined') {\n            this.items = [head];\n        }\n        else {\n            this.items = [];\n        }\n\n        this.type = SExpType.List;\n    }\n\n    add(item) {\n        this.items.push(item);\n    }\n}\n\nexport class BoolLiteral {\n    constructor(value) {\n        this.value = value;\n        this.type = SExpType.BoolLiteral;\n    }\n}\n\nexport class IntLiteral {\n    constructor(value) {\n        this.value = value;\n        this.type = SExpType.IntLiteral;\n    }\n}\n\nexport class StringLiteral {\n    constructor(value) {\n        this.value = value;\n        this.type = SExpType.StringLiteral;\n    }\n}\n\nexport class SSymbol {\n    constructor(value) {\n        this.value = value;\n        this.type = SExpType.Symbol;\n    }\n}\n\nexport class ParseError {\n    constructor(message, line, column) {\n        this.message = message;\n        this.line = line;\n        this.column = column;\n    }\n}\n\nexport class Constructor {\n    constructor(name, values, length) {\n        this.name = name;\n        this.values = values;\n        this.length = length;\n    }\n\n    startsWith(str) {\n        return this.name.value === str;\n    }\n\n    get(index, type) {\n        if (this.values.items[index].type === type) {\n            return Maybe.Some(this.values.items[index]);\n        }\n        else {\n            return Maybe.None();\n        }\n    }\n}\n\nexport const KnownContainers = Object.freeze({\n    Grid: Symbol(\"Grid\"),\n    ListView: Symbol(\"ListView\"),\n});\n\nexport const KnownElements = Object.freeze({\n    Label: Symbol(\"Label\"),\n});\n\nexport const KnownType = Object.freeze({\n    Container: Symbol(\"Container\"),\n    Element: Symbol(\"Element\")\n});\n\nexport function getConstructorType(constructor) {\n    //see if its a container first\n    if (constructor.startsWith(\"grid\")) {\n        return Maybe.Some([KnownType.Container, KnownContainers.Grid]);\n    }\n    else if (constructor.startsWith(\"list-view\")) {\n        return Maybe.Some([KnownType.Container, KnownContainers.ListView]);\n    }\n\n    //then see if its an element\n    if (constructor.startsWith(\"label\")) {\n        return Maybe.Some([KnownType.Element, KnownElements.Label]);\n    }\n\n    return Maybe.None();\n}\n\nexport function getConstructor(expression) {\n    if (expression.type !== SExpType.List) {\n        return Maybe.None();\n    }\n\n    if (expression.items.length === 0) {\n        return Maybe.None();\n    }\n\n    if (expression.items[0].type !== SExpType.Symbol) {\n        return Maybe.None();\n    }\n\n    return Maybe.Some(new Constructor(expression.items[0],\n            expression,\n            expression.items.length));\n}\n\nfunction isDigit(c) {\n    switch (c) {\n        case '0':\n        case '1':\n        case '2':\n        case '3':\n        case '4':\n        case '5':\n        case '6':\n        case '7':\n        case '8':\n        case '9': return true;\n        default: return false;\n    }\n}\n\nconst LiteralType = Object.freeze({\n    None: Symbol(\"none\"),\n    Int: Symbol(\"int\"),\n    Float: Symbol(\"float\"),\n    String: Symbol(\"string\")\n});\n\nexport const SExpType = Object.freeze({\n    Symbol: Symbol(\"Symbol\"),\n    IntLiteral: Symbol(\"IntLiteral\"),\n    FloatLiteral: Symbol(\"FloatLiteral\"),\n    StringLiteral: Symbol(\"StringLiteral\"),\n    BoolLiteral: Symbol(\"BoolLiteral\"),\n    List: Symbol(\"List\"),\n});\n\nexport function read(input) {\n    let brackets = [];\n    let expressions = [];\n    let currentLine = 0;\n    let currentColumn = 0;\n    let topLevelExpressions = new List();\n\n    for(let i = 0; i < input.length; i++) {\n        let c = input[i];\n        currentColumn++;\n\n        switch(c) {\n            case '(':\n            case '[':\n            case '{': {\n                brackets.push(c);\n                expressions.push(new List());\n                break;\n            }\n            case ')':\n            case ']':\n            case '}': {\n\n                if (brackets.length === 0 || expressions.length === 0) {\n                    return new ParseError(\"Unexpected closing bracket\", currentLine, currentColumn);\n                }\n\n                if (!bracketMatches(brackets[brackets.length - 1], c)) {\n                    return new ParseError(\"Mismatched bracket\", currentLine, currentColumn);\n                }\n\n                let completedExpression = expressions.pop();\n\n                if (expressions.length === 0) {\n                    topLevelExpressions.add(completedExpression);\n                }\n                else {\n                    let top = expressions[expressions.length - 1];\n\n                    if (top instanceof List) {\n                        top.add(completedExpression);\n                    }\n                    else {\n                        return new ParseError(\"Expected list\", currentLine, currentColumn);\n                    }\n                }\n\n                break;\n            }\n            case '\\n': {\n                currentLine++;\n                currentColumn = 0;\n                break;\n            }\n            case ' ':\n            case '\\t': {\n                continue;\n            }\n            default: {\n\n                let top = expressions[expressions.length - 1];\n\n                if (!(top instanceof List)) {\n                    return new ParseError(\"Expected list\", currentLine, currentColumn);\n                }\n\n                let type = LiteralType.None;\n\n                if (isDigit(c)) {\n                    type = LiteralType.Int;\n                }\n                else if (c === '\"') {\n                    type = LiteralType.String;\n                }\n                else {\n                    if (input.slice(i, 4) === \"true\"\n                            && \" )]}\".includes(input[i + 4])) {\n                        top.add(new BoolLiteral(true));\n                        i += 4;\n                        continue;\n                    }\n                    else if (input.slice(i, 5) === \"false\"\n                            && \" )]}\".includes(input[i + 5])) {\n                        top.add(new BoolLiteral(false));\n                        i += 5;\n                        continue;\n                    }\n                }\n\n                let done = false;\n                let j = i;\n\n                for (; j < input.length; j++) {\n                    c = input[j];\n\n                    switch (type) {\n                        case LiteralType.Int: {\n\n                            if (c === \".\") {\n                                type = LiteralType.Float;\n                            }\n                            else if (!isDigit(c)) {\n                                done = true;\n                                break;\n                            }\n\n                            break;\n                        }\n                        case LiteralType.Float: {\n\n                            if (c === \".\") {\n                                return new ParseError(\"Unexpected second '.' in float literal\", currentLine, currentColumn);\n                            }\n                            else if (!isDigit(c)) {\n                                done = true;\n                                break;\n                            }\n\n                            break;\n                        }\n                        case LiteralType.String: {\n                            if (c === '\"' && j > i) {\n                                j++;\n                                done = true;\n                            }\n\n                            break;\n                        }\n                        case LiteralType.None: {\n                            if (c === '(' || c === ')' || c === '\\n' || c === ' ' || c === '\\t') {\n                                done = true;\n                            }\n\n                            break;\n                        }\n                        default: return new ParseError(\"This isn't possible\", currentLine, currentColumn);\n                    }\n\n                    if (done) {\n                        break;\n                    }\n                }\n\n                let value = input.slice(i, j);\n\n                switch (type) {\n                    case LiteralType.Int: {\n                        top.add(new IntLiteral(Number.parseInt(value)));\n                        break;\n                    }\n                    case LiteralType.Float: {\n                        return new ParseError(\"Float parsing not implemented\", currentLine, currentColumn);\n                    }\n                    case LiteralType.String: {\n                        top.add(new StringLiteral(input.slice(i + 1, j - 1)));\n                        break;\n                    }\n                    case LiteralType.None: {\n                        top.add(new SSymbol(value));\n                        break;\n                    }\n                    default: return new ParseError(\"This isn't possible\", currentLine, currentColumn);\n                }\n\n                i += (j - i) - 1;\n\n                break;\n            }\n        }\n    }\n\n    return topLevelExpressions;\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nexport class Configuration {\n    constructor() {\n        this.meta = null;\n        this.backgroundColour = \"\";\n        this.fontColour = \"\";\n        this.margins = {vertical: 0, horizontal: 0};\n        this.padding = {vertical: 0, horizontal: 0};\n        this.horizontalAlignment = Alignment.Start;\n        this.verticalAlignment = Alignment.Start;\n        this.fontSize = 14;\n    }\n}\n\nexport const Alignment = Object.freeze({\n    Start: Symbol(\"Start\"),\n    Center: Symbol(\"Center\"),\n    End: Symbol(\"End\")\n});","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {Alignment} from './configuration';\n\nexport function adjustForAlignment(coordinate, alignment, boundedLength, contentLength) {\n\n    switch (alignment) {\n        case Alignment.Start: {\n            //nothing needed for start alignment as its the default\n            break;\n        }\n        case Alignment.Center: {\n            coordinate += (boundedLength / 2) - (contentLength / 2);\n            break;\n        }\n        case Alignment.End: {\n            coordinate += boundedLength - contentLength;\n            break;\n        }\n        default: break;\n    }\n\n    return coordinate;\n}\n\n/*\nBase class for all elements\n*/\nexport class UIElement {\n    constructor(config) {\n        this.parent = null;\n\n        this.backgroundColour = config.backgroundColour;\n        this.fontColour = config.fontColour;\n\n        this.horizontalAlignment = config.horizontalAlignment;\n        this.verticalAlignment = config.verticalAlignment;\n\n        if (!(config.margins.vertical < 0 || config.margins.horizontal < 0)) {\n            this.margins = config.margins;\n        }\n\n        if (!(config.padding.vertical < 0 || config.padding.horizontal < 0)) {\n            this.padding = config.padding;\n        }\n    }\n\n    getParent() { return this.parent; }\n    setParent(parent) { this.parent = parent; }\n\n    getBounds(bounds = null) { \n        if (bounds == null) {\n            bounds = this.parent.getChildBounds(this);\n        }\n\n        let horizontalMarginSpace = 2 * this.margins.horizontal;\n\n        if (bounds.width > horizontalMarginSpace) {\n            bounds.width -= horizontalMarginSpace;\n            bounds.x += this.margins.horizontal;\n        }\n\n        let verticalMarginSpace = 2 * this.margins.vertical;\n\n        if (bounds.height > verticalMarginSpace) {\n            bounds.height -= verticalMarginSpace;\n            bounds.y += this.margins.vertical;\n        }\n\n        return bounds;\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {Maybe} from '../../maybe';\nimport {SExpType, getConstructor} from '../parsing';\nimport {parseElement} from './element';\nimport {UIElement, adjustForAlignment} from './uielement';\nimport {Configuration} from './configuration';\n\nexport class LabelConfiguration extends Configuration {\n    constructor() {\n        super();\n\n        this.caption = \"\";\n    }\n}\n\nexport class Label extends UIElement {\n\n    constructor(config) {\n        super(config);\n\n        this.caption = config.caption;\n    }\n\n    static Create(config) {\n        let label = new Label(config);\n\n        //TODO: the bindings stuff\n\n        return label;\n    }\n\n    render(renderer, bounds, clip) {\n        //TODO: caption binding, see label.h:141\n        let captionText = this.caption.value;\n        bounds = this.getBounds(bounds);\n\n        renderer.drawRectangle(this.backgroundColour, bounds, clip);\n\n        if (captionText === null) {\n            return;\n        }\n\n        /*bounds.x = adjustForAlignment(bounds.x, \n                this.horizontalAlignment, \n                bounds.width, \n                captionLayout.bounds.width);        \n        bounds.x += padding.horizontal;\n        bounds.y = adjustForAlignment(bounds.y, \n            this.verticalAlignment, \n            bounds.height, \n            captionLayout.bounds.height);\n        bounds.y += padding.vertical;*/\n\n        renderer.drawText(captionText/*Layout*/, bounds, clip, this.backgroundColour);\n    }\n}\n\nexport function parseLabel(label) {\n    if (label.type !== SExpType.List) {\n        return Maybe.None();\n    }\n\n    let config = new LabelConfiguration();\n    let first = true;\n\n    for (let item of label.items) {\n        if (first) {\n            first = false;\n\n            if (item.type !== SExpType.Symbol \n                    || item.value !== \"label\") {\n                return Maybe.None();\n            }\n\n            continue;\n        }\n\n        let constructor = getConstructor(item)\n            .bind(constructor => {\n                if (constructor.startsWith(\"caption\")) {\n                    if (constructor.length !== 2) {\n                        return Maybe.None();\n                    }\n\n                    //TODO: databinding\n                    constructor.get(1, SExpType.StringLiteral)\n                        .bind(caption => config.caption = caption);\n                }\n                else if (constructor.startsWith(\"meta\")) {\n                    config.meta = constructor.values;\n                }\n                else if (!parseElement(item, config)) {\n                    return Maybe.None();\n                }\n\n                return Maybe.Some(constructor);\n            });\n        \n        if (!constructor.isSome()) {\n            return Maybe.None();\n        }\n    }\n\n    return Maybe.Some(config);\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {GridMetaId} from './grid';\nimport {getConstructor, SExpType} from '../parsing';\nimport {Maybe} from '../../maybe';\nimport {UIElement} from './uielement';\n\nexport const MetaNamespace = Object.freeze({\n    Grid: Symbol(\"GridNamespace\"),\n});\n\nexport class MetaData {\n    constructor (namespace, id, value) {\n        this.containerNamespace = namespace;\n        this.metaId = id;\n        this.value = value;\n    }\n}\n\nexport function parseGridMeta(grid, meta) {\n    let count = grid.values.items.length;\n\n    if (count < 2) {\n        return Maybe.None();\n    }\n\n    for (let i = 1; i < count; i++) {\n        let result = getConstructor(grid.values.items[i])\n            .bind(constructor => {\n                if (constructor.startsWith(\"row\") && constructor.length === 2) {\n                    return constructor.get(1, SExpType.IntLiteral)\n                        .bind(value => {\n                            meta.push(new MetaData(MetaNamespace.Grid, GridMetaId.Row, value.value));\n                            return Maybe.Some(1);\n                        });\n                }\n                else if (constructor.startsWith(\"column\") && constructor.length === 2) {\n                    return constructor.get(1, SExpType.IntLiteral)\n                        .bind(value => {\n                            meta.push(new MetaData(MetaNamespace.Grid, GridMetaId.Column, value.value));\n                            return Maybe.Some(1);\n                        });\n                }\n                else if (constructor.startsWith(\"row-span\") && constructor.length === 2) {\n                    return constructor.get(1, SExpType.IntLiteral)\n                        .bind(value => {\n                            meta.push(new MetaData(MetaNamespace.Grid, GridMetaId.RowSpan, value.value));\n                            return Maybe.Some(1);\n                        });\n                }\n                else if (constructor.startsWith(\"column-span\") && constructor.length === 2) {\n                    return constructor.get(1, SExpType.IntLiteral)\n                        .bind(value => {\n                            meta.push(new MetaData(MetaNamespace.Grid, GridMetaId.ColumnSpan, value.value));\n                            return Maybe.Some(1);\n                        });\n                } \n                else {\n                    return Maybe.None();\n                }\n            });\n\n        if (!result.isSome()) {\n            return Maybe.None();\n        }\n    }\n\n    return Maybe.Some(grid);\n}\n\nexport function parseMeta(config) {\n    if (config.items.length < 2) {\n        return Maybe.None();\n    }\n\n    let meta = [];\n\n    for (let i = 1; i < config.items.length; i++) {\n        let result = getConstructor(config.items[i])\n            .bind(constructor => {\n                if (constructor.startsWith(\"grid\")) {\n                    return parseGridMeta(constructor, meta);\n                }\n                else {\n                    return Maybe.Some(1);\n                }\n            });\n\n        if (!result.isSome()) {\n            return Maybe.None();\n        }\n    }\n\n    return Maybe.Some(meta);\n}\n\nexport class Container extends UIElement {\n\n    /*\n    Forwards text layout requests up the ui hierarchy until it\n    reaches the Window, which is capable of performing the request.\n    */\n    requestTextLayout(element) {\n\n        if (this.parent != null) {\n            this.parent.requestTextLayout(element);\n        }\n    }\n\n    /*\n    Forwards render requests up the ui hierarchy until it\n    reaches the Window, which is capable of performing the request.\n    */\n    requestRender(element) {\n\n        if (this.parent != null) {\n            this.parent.requestRender(element);\n        }\n    }\n}\n\nexport class ContainedElement {\n    constructor(element, bounds) {\n        this.element = element;\n        this.bounds = bounds;\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {getConstructor, SExpType, KnownElements} from '../parsing';\nimport {Maybe} from '../../maybe';\nimport {parseLabel, Label} from './label';\nimport {parseMeta} from './container';\nimport {Alignment} from './configuration';\n\nfunction parseMargins(margins, config) {\n    if (margins.items.length === 1) {\n        return null;\n    }\n\n    for (let i = 1; i < margins.items.length; i++) {\n        let failed = true;\n\n        let constructor = getConstructor(margins.items[i]);\n\n        if (constructor.isSome()) {\n            constructor = constructor.value();\n\n            if (constructor.length !== 2) {\n                return false;\n            }\n\n            let value = constructor.get(1, SExpType.IntLiteral);\n\n            if (value.isSome()) {\n                if (constructor.startsWith(\"vertical\")) {\n                    config.vertical = value.value().value;\n                    failed = false;\n                }\n                else if (constructor.startsWith(\"horizontal\")) {\n                    config.horizontal = value.value().value;\n                    failed = false;\n                }\n            }\n        }\n\n        if (failed) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction getAlignment(name) {\n    if (name === \"start\") {\n        return Alignment.Start;\n    }\n    else if (name === \"center\") {\n        return Alignment.Center;\n    }\n    else if (name === \"end\") {\n        return Alignment.End;\n    }\n\n    return null;\n}\n\nfunction parseAlignment(alignment, config) {\n    if (alignment.items.length === 1) {\n        return null;\n    }\n\n    for (let i = 1; i < alignment.items.length; i++) {\n        let failed = true;\n\n        let constructor = getConstructor(alignment.items[i]);\n\n        if (constructor.isSome()) {\n            constructor = constructor.value();\n\n            if (constructor.length !== 2) {\n                return false;\n            }\n\n            let value = constructor.get(1, SExpType.Symbol);\n\n            if (value.isSome()) {\n                if (constructor.startsWith(\"vertical\")) {\n                    let maybeAlignment = getAlignment(value.value().value);\n                    \n                    if (maybeAlignment !== null) {\n                        config.verticalAlignment = maybeAlignment;\n                        failed = false;\n                    }\n                }\n                else if (constructor.startsWith(\"horizontal\")) {\n                    let maybeAlignment = getAlignment(value.value().value);\n                    \n                    if (maybeAlignment !== null) {\n                        config.horizontalAlignment = maybeAlignment;\n                        failed = false;\n                    } \n                }\n            }\n        }\n\n        if (failed) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction parseColour(constructor) {\n    return constructor.get(1, SExpType.List)\n        .bind(colour => getConstructor(colour))\n        .bind(colourConstructor => {\n            if (colourConstructor.startsWith(\"rgb\")) {\n                if (colourConstructor.length !== 4) {\n                    return Maybe.None();\n                }\n        \n                return colourConstructor.get(1, SExpType.IntLiteral)\n                    .bind(r => colourConstructor.get(2, SExpType.IntLiteral)    \n                        .bind(g => colourConstructor.get(3, SExpType.IntLiteral)\n                            .bind(b => {\n                                return Maybe.Some(\"rgb(\" + r.value + \",\" + g.value + \",\" + b.value + \")\");\n                            })));\n            }\n            else if (colourConstructor.startsWith(\"bind\")) {\n                console.log(\"TODO: colour binding not supported\");\n            }\n\n            return Maybe.None();\n        });\n}\n\nfunction getColour(constructor) {\n    if (constructor.length !== 2) {\n        return Maybe.None();\n    }\n\n    return parseColour(constructor);\n}\n\nexport function parseElement(element, config) {\n    let constructor = getConstructor(element);\n\n    if (constructor.isSome()) {\n        constructor = constructor.value();\n\n        if (constructor.startsWith(\"background\")) {\n            let colour = getColour(constructor);\n\n            if (!colour.isSome()) {\n                return false;\n            }\n\n            config.backgroundColour = colour.value();\n        }\n        else if (constructor.startsWith(\"font-colour\")) {\n            let colour = getColour(constructor);\n\n            if (!colour.isSome()) {\n                return false;\n            }\n\n            config.fontColour = colour.value();\n        }\n        else if (constructor.startsWith(\"margins\")) {\n            return parseMargins(constructor.values, config.margins);\n        }\n        else if (constructor.startsWith(\"padding\")) {\n            return parseMargins(constructor.values, config.padding);\n        }\n        else if (constructor.startsWith(\"alignment\")) {\n            return parseAlignment(constructor.values, config);\n        }\n        else if (constructor.startsWith(\"font-size\")) {\n            if (constructor.length !== 2) {\n                return false;\n            }\n\n            let fontSize = constructor.get(1, SExpType.IntLiteral);\n\n            if (!fontSize.isSome()) {\n                return false;\n            }\n\n            config.fontSize = fontSize.value();\n        }\n    }\n\n    return true;\n}\n\nexport function createElement(parent, type, constructor) {\n    switch (type) {\n        case KnownElements.Label: {\n            let label = parseLabel(constructor.values)\n                .bind(config => Maybe.Some([config, Label.Create(config)]))\n                .bind(([config, label]) => {\n                    if (config.meta != null) {\n                        let meta = parseMeta(config.meta);\n\n                        if (meta.isSome()) {\n                            parent.addChild(label, meta.value());\n                        }\n                        else {\n                            parent.addChild(label);\n                        }\n                    }\n                    else {\n                        parent.addChild(label);\n                    }\n\n                    return Maybe.Some(label);\n                });\n\n            return label;\n        }\n        default: return Maybe.None();\n    }\n}\n\nexport class Bounds {\n    constructor(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {SExpType, getConstructor} from '../parsing';\nimport {parseElement, Bounds} from './element';\nimport {Container, ContainedElement, MetaNamespace} from './container';\nimport {Configuration} from './configuration';\nimport {Maybe} from '../../maybe';\n\nexport const GridMetaId = Object.freeze({\n    Row: 1,\n    Column: 2,\n    RowSpan: 3,\n    ColumnSpan: 4\n});\n\nclass GridElement extends ContainedElement {\n    constructor() {\n        super();\n        this.row = 0;\n        this.column = 0;\n        this.rowSpan = 0;\n        this.columnSpan = 0;\n    }\n}\n\nfunction getCellBounds(row, column) {\n    return new Bounds(column.startingPosition, row.startingPosition,\n            column.actualSpace, row.actualSpace);\n}\n\nfunction getSpannedCellBounds(rows, columns, element) {\n    \n    let bounds = new Bounds(columns[element.column].startingPosition, \n            rows[element.row].startingPosition,\n            columns[element.column].actualSpace, \n            rows[element.row].actualSpace);\n\n    if (element.rowSpan > 0) {\n        let row = rows[element.row + element.rowSpan - 1];\n        bounds.height = row.startingPosition + row.actualSpace - bounds.y;\n    }\n\n    if (element.columnSpan > 0) {\n        let column = columns[element.column + element.columnSpan - 1];\n        bounds.width = column.startingPosition + column.actualSpace - bounds.x;\n    }\n\n    return bounds;\n}\n\n/*\nA Grid is a container that arranges multiple child\nelements in rows and columns.\n*/\nexport class Grid extends Container {\n    constructor(config) {\n        super(config);\n\n        this.children = [];\n        this.rows = config.rows;\n        this.columns = config.columns;\n        this.rowGap = config.rowGap;\n        this.columnGap = config.columnGap;\n\n        this.itemSource = null;\n        this.itemTemplate = null;\n    }\n\n    addChild(child, meta) {\n        let element = new GridElement();\n        element.element = child;\n\n        if (typeof meta !== \"undefined\") {\n            this.applyMetaData(element, meta);\n        }\n\n        element.bounds = getCellBounds(this.rows[element.row], this.columns[element.column]);\n        this.children.push(element);\n\n        child.setParent(this);\n    }\n\n    applyMetaData(element, meta) {\n        for (let data of meta) {\n            if (data.containerNamespace !== MetaNamespace.Grid) {\n                continue;\n            }\n\n            switch (data.metaId) {\n                case GridMetaId.Row: {\n                    element.row = Math.max(0,\n                            Math.min(data.value, this.rows.length - 1));\n                    break;\n                }\n                case GridMetaId.Column: {\n                    element.column = Math.max(0,\n                            Math.min(data.value, this.columns.length - 1));\n                    break;\n                }\n                case GridMetaId.RowSpan: {\n                    element.rowSpan = data.value;\n                    break;\n                }\n                case GridMetaId.ColumnSpan: {\n                    element.columnSpan = data.value;\n                    break;\n                }\n                default: break;\n            }\n        }\n\n        if (element.rowSpan > 0) {\n            let maxRow = element.row = element.rowSpan;\n\n            if (maxRow > this.rows.length) {\n                element.rowSpan = this.rows.length - element.row;\n            }\n        }\n\n        if (element.columnSpan > 0) {\n            let maxColumn = element.column + element.columnSpan;\n\n            if (maxColumn > this.columns.length) {\n                element.columnSpan = this.columns.length - element.column;\n            }\n        }\n    }\n\n    allocateDefinitionSpace(definitions, unallocatedSpace, currentPosition, gap) {\n        let totalProportionalUnits = 0;\n\n        if (gap.value > 0) {\n            unallocatedSpace -= gap.value * (definitions.length - 1);\n        }\n\n        for (let definition of definitions) {\n            if (definition.unit === Unit.Fixed) {\n                if (unallocatedSpace > 0) {\n                    let space = Math.min(unallocatedSpace, definition.desiredSpace);\n                    definition.actualSpace = space;\n                    unallocatedSpace -= space;\n                }\n                else {\n                    break;\n                }\n            }\n            else {\n                totalProportionalUnits += definition.desiredSpace;\n            }\n        }\n\n        if (totalProportionalUnits > 0 \n            && unallocatedSpace > 0) {\n\n            let proportionalSpace = unallocatedSpace / totalProportionalUnits;\n            \n            for (let definition of definitions) {\n                if (definition.unit === Unit.Proportional) {\n                    definition.actualSpace = proportionalSpace * definition.desiredSpace;\n                }\n            }\n        }\n\n        for (let definition of definitions) {\n            definition.startingPosition = currentPosition;\n            currentPosition += definition.actualSpace + gap.value;\n        }\n    }\n\n    calculateGridDimensions() {\n        let bounds = this.getBounds();\n\n        this.allocateDefinitionSpace(this.rows, bounds.height, bounds.y, this.rowGap);\n        this.allocateDefinitionSpace(this.columns, bounds.width, bounds.x, this.columnGap);\n    }\n\n    /*\n    Arranges the children in some fashion by calculating each\n    child element's bounds\n    */\n    layoutChildren() {\n        if (this.children.length === 0) {\n            return;\n        }\n\n        this.calculateGridDimensions();\n\n        for (let child of this.children) {\n            if (child.rowSpan > 0 || child.columnSpan > 0) {\n                child.bounds = getSpannedCellBounds(this.rows, this.columns, child);\n            }\n            else {\n                child.bounds = getCellBounds(this.rows[child.row], this.columns[child.column]);\n            }\n\n            if (child.element instanceof Container) {\n                child.element.layoutChildren();\n            }\n        }\n    }\n\n    /*\n    Returns the bounds of the given child. Bounds are calculated\n    in a layoutChildren call and stored in the ContainedElement\n    */\n    getChildBounds(child) {\n        for (let element of this.children) {\n            if (element.element === child) {\n                return element.bounds;\n            }\n        }\n\n        return new Bounds();\n    }\n\n    render(renderer, bounds, clip) {\n        for (let element of this.children) {\n            element.element.render(renderer, element.bounds, bounds);\n        }\n    }\n}\n\nclass GridConfiguration extends Configuration {\n    constructor() {\n        super();\n\n        this.rows = [];\n        this.columns = [];\n        this.items = null;\n        this.rowGap = 0;\n        this.columnGap = 0;\n        this.itemSource = null;\n        this.itemTemplate = null;\n    }\n}\n\nexport const Unit = Object.freeze({\n    Proportional: Symbol(\"Proportional\"),\n    Fixed: Symbol(\"Fixed\"),\n});\n\nclass RowColumnDefinition {\n    constructor(unit, desiredSpace) {\n        this.unit = unit;\n        this.desiredSpace = desiredSpace;\n        this.actualSpace = 0;\n        this.startingPosition = 0;\n    }\n}\n\nfunction parseRowColumn(config, definitions, proportional, fixed) {\n    if (config.items.length === 1) {\n        return false;\n    }\n\n    for (let i = 1; i < config.items.length; i++) {\n        let constructor = getConstructor(config.items[i])\n            .bind(constructor => {\n                return constructor.get(1, SExpType.IntLiteral)\n                    .bind(value => {\n                        if (constructor.startsWith(proportional)) {\n                            definitions.push(new RowColumnDefinition(Unit.Proportional, value.value));\n                        }\n                        else if (constructor.startsWith(fixed)) {\n                            definitions.push(new RowColumnDefinition(Unit.Fixed, value.value));\n                        }\n                        else {\n                            return Maybe.None();\n                        }\n\n                        return Maybe.Some(1);\n                    });\n            });\n        \n        if (!constructor.isSome()) {\n            return false;\n        }\n\n    }\n\n    return true;\n}\n\nexport function parseGrid(grid) {\n\n    if (grid.type !== SExpType.List) {\n        return Maybe.None();\n    }\n\n    let config = new GridConfiguration();\n    let first = true;\n\n    for (let item of grid.items) {\n        if (first) {\n            first = false;\n\n            if (item.type !== SExpType.Symbol\n                    || item.value !== \"grid\") {\n                return Maybe.None();\n            }\n\n            continue;\n        }\n\n        let constructor = getConstructor(item)\n            .bind(constructor => {\n                if (constructor.startsWith(\"rows\")) {\n                    if (!parseRowColumn(constructor.values, config.rows, \n                            \"proportional-height\", \"fixed-height\")) {\n                        return Maybe.None();\n                    }\n                }\n                else if (constructor.startsWith(\"columns\")) {\n                    if (!parseRowColumn(constructor.values, config.columns,\n                            \"proportional-width\", \"fixed-width\")) {\n                        return Maybe.None();\n                    }\n                }\n                else if (constructor.startsWith(\"items\")) {\n                    config.items = constructor.values;\n                }\n                else if (constructor.startsWith(\"item-source\")) {\n                    let itemSource = constructor.get(1, SExpType.List);\n        \n                    if (itemSource.isSome()) {\n                        config.itemSource = itemSource.value();\n                    }\n                }\n                else if (constructor.startsWith(\"item-template\")) {\n                    let template = constructor.get(1, SExpType.List);\n        \n                    if (template.isSome()) {\n                        config.itemTemplate = template.value();\n                    }\n                }\n                else if (constructor.startsWith(\"meta\")) {\n                    config.meta = constructor.values;\n                }\n                else if (constructor.startsWith(\"row-gap\")) {\n                    if (constructor.length !== 2) {\n                        return Maybe.None();\n                    }\n        \n                    let value = constructor.get(1, SExpType.IntLiteral);\n        \n                    if (value.isSome()) {\n                        config.rowGap = value.value();\n                    }\n                    else {\n                        return Maybe.None();\n                    }\n                }\n                else if (constructor.startsWith(\"column-gap\")) {\n                    if (constructor.length !== 2) {\n                        return Maybe.None();\n                    }\n        \n                    let value = constructor.get(1, SExpType.IntLiteral);\n        \n                    if (value.isSome()) {\n                        config.columnGap = value.value();\n                    }\n                    else {\n                        return Maybe.None();\n                    }\n                }\n                else if (!parseElement(item, config)) {\n                    return Maybe.None();\n                }\n\n                return Maybe.Some(constructor);\n            });\n\n        if (!constructor.isSome()) {\n            return Maybe.None();\n        }\n    }\n\n    return Maybe.Some(config);\n}\n\nexport function createGrid(config) {\n    let grid = new Grid(config);\n\n    //TODO: setup itemsource binding, see grid.h: 94\n\n    return grid;\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {Maybe} from '../maybe';\nimport {getConstructor, getConstructorType, KnownType, KnownContainers, SExpType} from './parsing';\nimport {parseGrid, createGrid} from './elements/grid';\nimport {createElement} from './elements/element';\nimport {parseMeta} from './elements/container';\n\nfunction createItems(constructor, parent) {\n    let first = true;\n\n    for (let item of constructor.values.items) {\n        if (first) {\n            if (item.type !== SExpType.Symbol\n                    || item.value !== 'items') {\n                return Maybe.None();\n            }\n\n            first = false;\n            continue;\n        }\n\n        let child = getConstructor(item)\n            .bind(constructor => {\n                return getConstructorType(constructor)\n                    .bind(type => Maybe.Some([constructor, type]));\n            })\n            .bind(([constructor, type]) => {\n                if (type[0] === KnownType.Container) {\n                    return createContainer(parent, type[1], constructor);\n                }\n                else {\n                    return createElement(parent, type[1], constructor);\n                }\n            });\n\n        if (!child.isSome()) {\n            return Maybe.None();\n        }\n    }\n\n    return Maybe.Some(parent);\n}\n\nfunction createContainerItems(parent, itemList) {\n    if (itemList === null || itemList.type !== SExpType.List) {\n        return Maybe.None();\n    }\n\n    return getConstructor(itemList)\n        .bind(constructor => createItems(constructor, parent));\n}\n\nfunction finishContainer(container, parent, meta) {\n    if (container.isSome()) {\n        container = container.value();\n    }\n    else {\n        return Maybe.None();\n    }\n\n    if (meta !== null) {\n        let metaData = parseMeta(meta);\n\n        if (metaData.isSome()) {\n            parent.addChild(container, metaData.value());\n        }\n        else {\n            parent.addChild(container);\n        }\n    }\n    else {\n        parent.addChild(container);\n    }\n\n    return Maybe.Some(container);\n}\n\nexport function createContainer(parent, type, constructor) {\n    switch (type) {\n        case KnownContainers.Grid: {\n            let grid = parseGrid(constructor.values)\n                .bind(config => Maybe.Some([config, createGrid(config)]))\n                .bind(([config, grid]) => Maybe.Some([config, createContainerItems(grid, config.items)]))\n                .bind(([config, grid]) => finishContainer(grid, parent, config.meta));\n\n            return grid;\n        }\n        case KnownContainers.ListView: {\n            break;\n        }\n        default: return Maybe.None();\n    }\n\n    return Maybe.None();\n}\n\nexport function loadLayout(root, window) {\n    let container = getConstructor(root)\n        .bind(constructor => {\n            return getConstructorType(constructor)\n                .bind(type => Maybe.Some([constructor, type]));  \n        })\n        .bind(([constructor, type]) => {\n            if (type[0] === KnownType.Container) {\n                return createContainer(window, type[1], constructor);\n            }  \n            else {\n                return Maybe.None();\n            }\n        });\n    \n    if (container.isSome()) {\n        return container.value();\n    }\n    else {\n        return null;\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport {Container} from './container';\nimport {Bounds} from './element';\nimport {Configuration} from './configuration';\n\nexport class UIWindow extends Container {\n    constructor(canvas) {\n        super(new Configuration());\n        this.child = null;\n        this.canvas = canvas;\n        this.renderer = null;\n    }\n\n    addChild(element) {\n        this.child = element;\n        this.child.setParent(this);\n    }\n\n    setRenderer(renderer) {\n        this.renderer = renderer;\n    }\n\n    /*\n    Arranges the children in some fashion by calculating each\n    child element's bounds\n    */\n    layoutChildren() {\n        if (this.child != null) {\n            this.child.layoutChildren();\n        }\n    }\n\n    /*\n    Returns the bounds of the given child. Bounds are calculated\n    in a layoutChildren call and stored in the ContainedElement\n    */\n    getChildBounds(child) {\n        return new Bounds(0, 0, this.canvas.clientWidth, this.canvas.clientHeight);\n    }\n\n    render() {\n        \n        if (this.child != null) {\n            let bounds = this.getChildBounds(null);\n            this.child.render(this.renderer, bounds, bounds);\n        }\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nexport class Renderer  {\n    constructor(canvas) {\n        this.canvas = canvas;\n        this.context = this.canvas.getContext('2d');\n    }\n\n    clear() {\n\n        this.context.fillStyle = 'rgba(255,255,255,1)';\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    drawRectangle(colour, bounds, clip) {\n        let windowWidth = this.canvas.clientWidth;\n        let windowHeight = this.canvas.clientHeight;\n\n        if (bounds.x >= windowWidth || bounds.y >= windowHeight) {\n            return;\n        }\n\n        let x = bounds.x;\n        let y = bounds.y;\n        let clippedWidth = bounds.width;\n        let clippedHeight = bounds.height;\n\n        if (bounds.x < clip.x) {\n            x = clip.x;\n            clippedWidth -= (clip.x - bounds.x);\n        }\n\n        if (bounds.y < clip.y) {\n            y = clip.y;\n            clippedHeight -= (clip.y - bounds.y);\n        }\n\n        if ((x + clippedWidth) >= (clip.x + clip.width)) {\n            clippedWidth = clip.x + clip.width - x;\n        }\n\n        if ((y + clippedHeight) >= (clip.y + clip.height)) {\n            clippedHeight = clip.y + clip.height - y;\n        }\n\n        if (clippedWidth < 0 || clippedHeight < 0) {\n            return;\n        }\n\n        this.context.fillStyle = colour;\n        this.context.fillRect(x, y, clippedWidth, clippedHeight);\n    }\n\n    drawText(layout, bounds, clip, backgroundColour) {\n        this.context.fillStyle = 'rgb(0,0,0)';\n        this.context.fillText(layout, bounds.x, bounds.y);\n    }\n}","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport React from 'react';\nimport './css/display.css';\nimport {read} from './apollo/parsing';\nimport {loadLayout} from './apollo/layout';\nimport {UIWindow} from './apollo/elements/window';\nimport {Renderer} from './apollo/renderer';\n\nclass Display extends React.Component {\n    constructor(props) {\n        super(props);\n        this.canvas = null;\n        this.context = null;\n        this.display = \n            <section className=\"display\">\n                <canvas id=\"framebuffer\" className=\"fullsize\" ref={node => {\n                    this.canvas = node\n                }}/>\n            </section>;\n    }\n\n    componentDidMount() {\n\n        const width = this.canvas.parentElement.clientWidth;\n        const height = this.canvas.parentElement.clientHeight;\n\n        this.canvas.height = height;\n        this.canvas.width = this.canvas.height * (width / height) ;\n\n        this.renderer = new Renderer(this.canvas);\n        this.window = new UIWindow(this.canvas);\n        this.window.setRenderer(this.renderer);\n    }\n\n    componentDidUpdate() {\n        const {layout} = this.props;\n\n        let result = read(layout);\n\n        if (this.renderer !== null)  {\n            this.renderer.clear();\n        }\n\n        if (result !== null) {\n            try {\n                let root = result.items[0];\n                let r = loadLayout(root, this.window);\n\n                if (r != null) {\n                    this.window.layoutChildren();\n                    //window.layoutText()\n                    this.window.render();\n                }\n            }\n            catch (exception) {\n                //TODO: put logging where display area is\n                console.log(exception);\n            }\n        }\n    }\n\n    render() {\n        return this.display;            \n    }\n}\n\nexport default Display;","export const ExampleLayout = `(grid\n    (margins (vertical 20) (horizontal 20))\n\n    (rows \n        (proportional-height 1)\n        (fixed-height 50)\n        (proportional-height 2))\n\n    (columns \n        (proportional-width 1)\n        (proportional-width 1))\n\n    (row-gap 20)\n    (column-gap 10)\n\n    (items \n        (label (caption \"Padded Label\")\n            (padding (vertical 50) (horizontal 100))\n            (font-colour (rgb 122 22 23))\n            (background (rgb 38 66 251)))\n        (label (caption \"Second\")\n            (background (rgb 24 205 4))\n            (font-colour (rgb 0 0 0))\n            (meta (grid (column 1))))\n\n        (label (caption \"cant bind yet\")\n            (background (rgb 69 69 69))\n            (meta (grid (row 1))))\n        (label (caption \"<- that one was typed\")\n            (background (rgb 37 13 37))\n            (meta (grid (row 1) (column 1))))\n\n        (label (caption \"Margined Label\")\n            (background (rgb 248 121 82))\n            (font-colour (rgb 169 5 40))\n            (margins (vertical 50) (horizontal 90))\n            (meta (grid (row 2))))\n\n        (grid\n\n            (rows \n                (proportional-height 2)\n                (proportional-height 1))\n\n            (columns \n                (proportional-width 1)\n                (proportional-width 1)\n                (proportional-width 1))\n\n            (row-gap 10)\n            (column-gap 10)\n\n            (items \n                (label (caption \"a\")\n                    (font-colour (rgb 10 10 10))\n                    (background (rgb 33 146 195)))\n                (label (caption \"b\")\n                    (background (rgb 62 16 140))\n                    (meta (grid (column 1))))\n                (label (caption \"3\")\n                    (font-colour (rgb 100 0 0))\n                    (background (rgb 241 220 69))\n                    (meta (grid (column 2))))\n\n                (label (caption \"spans 3 columns\")\n                    (background (rgb 12 87 117))\n                    (meta (grid (row 1) (column-span 3)))))\n\n            (meta (grid (row 2) (column 1))))))`;","/*\nCopyright (c) 2019, Patrick Lafferty\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n    * Neither the name of the copyright holder nor the names of its \n      contributors may be used to endorse or promote products derived from \n      this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR \nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport DocumentationViewer from './documentation';\nimport Editor from './editor';\nimport Display from './display';\nimport './css/apollo.css';\nimport {ExampleLayout} from './example_layout';\n\nclass ApolloApp extends React.Component {\n    constructor(props) {\n        super(props);\n        this.handleLayoutChanged = this.handleLayoutChanged.bind(this);\n        this.showDocumentation = this.showDocumentation.bind(this);\n        this.state = {layout: '', candidate: ''};\n\n        setTimeout(() => this.handleLayoutChanged(ExampleLayout), 300);\n    }\n\n    handleLayoutChanged(layout) {\n        this.setState({layout: layout});\n    }\n\n    showDocumentation(candidate) {\n        this.setState({candidate: candidate});\n    }\n\n    render() {\n        return (\n            <main className=\"app\">\n                <DocumentationViewer candidate={this.state.candidate}/>\n                <Editor handleLayoutChanged={this.handleLayoutChanged} \n                    showDocumentation={this.showDocumentation}\n                    initialLayout={this.state.layout}/>\n                <Display layout={this.state.layout} />\n            </main>\n        );\n    }\n}\n\nReactDOM.render(\n    <ApolloApp/>,\n    document.querySelector('#root'));"],"sourceRoot":""}